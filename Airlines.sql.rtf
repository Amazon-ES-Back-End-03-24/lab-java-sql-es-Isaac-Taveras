{\rtf1\ansi\ansicpg1252\cocoartf2761
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fmodern\fcharset0 Courier;\f1\fmodern\fcharset0 Courier-Oblique;}
{\colortbl;\red255\green255\blue255;\red195\green123\blue90;\red23\green23\blue26;\red174\green176\blue183;
\red185\green101\blue173;\red38\green157\blue169;\red89\green158\blue96;\red103\green107\blue114;\red72\green151\blue245;
\red254\green187\blue91;}
{\*\expandedcolortbl;;\csgenericrgb\c76471\c48235\c35294;\csgenericrgb\c9020\c9020\c10196;\csgenericrgb\c68235\c69020\c71765;
\csgenericrgb\c72549\c39608\c67843;\csgenericrgb\c14902\c61569\c66275;\csgenericrgb\c34902\c61961\c37647;\csgenericrgb\c40392\c41961\c44706;\csgenericrgb\c28235\c59216\c96078;
\csgenericrgb\c99608\c73333\c35686;}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\fs26 \cf2 \cb3 CREATE SCHEMA \cf4 Airlines;\
\
\cf2 CREATE TABLE Status \cf4 (\
    \cf5 status_id \cf2 INT NOT NULL PRIMARY KEY AUTO_INCREMENT\cf4 ,\
    \cf5 status_name \cf2 VARCHAR\cf4 (\cf6 255\cf4 ) \cf2 NOT NULL\
\cf4 );\
\
\cf2 CREATE TABLE \cf4 Customer (\
    \cf5 customer_id \cf2 INT NOT NULL PRIMARY KEY AUTO_INCREMENT\cf4 ,\
    \cf5 customer_name \cf2 VARCHAR\cf4 (\cf6 255\cf4 ) \cf2 NOT NULL\cf4 ,\
    \cf5 customer_status \cf2 INT NOT NULL\cf4 ,\
    \cf2 FOREIGN KEY \cf4 (\cf5 customer_status\cf4 ) \cf2 REFERENCES Status\cf4 (\cf5 status_id\cf4 )\
);\
\
\cf2 CREATE TABLE \cf4 Aircraft (\
    \cf5 aircraft_id \cf2 INT NOT NULL PRIMARY KEY AUTO_INCREMENT\cf4 ,\
    \cf5 aircraft_type \cf2 VARCHAR\cf4 (\cf6 255\cf4 ) \cf2 NOT NULL\
\cf4 );\
\
\cf2 CREATE TABLE \cf4 Flight (\
    \cf5 flight_id \cf2 INT NOT NULL PRIMARY KEY AUTO_INCREMENT\cf4 ,\
    \cf5 aircraft_id \cf2 INT NOT NULL\cf4 ,\
    \cf5 flight_number \cf2 VARCHAR\cf4 (\cf6 255\cf4 ) \cf2 NOT NULL\cf4 ,\
    \cf5 total_aircraft_seats \cf2 INT NOT NULL\cf4 ,\
    \cf5 flight_mileage \cf2 INT NOT NULL\cf4 ,\
    \cf2 FOREIGN KEY \cf4 (\cf5 aircraft_id\cf4 ) \cf2 REFERENCES \cf4 Aircraft(\cf5 aircraft_id\cf4 )\
);\
\
\cf2 CREATE TABLE \cf4 Mileage (\
    \cf5 mileage_id \cf2 INT NOT NULL PRIMARY KEY AUTO_INCREMENT\cf4 ,\
    \cf5 customer_id \cf2 INT NOT NULL\cf4 ,\
    \cf5 flight_id \cf2 INT NOT NULL\cf4 ,\
    \cf5 total_customer_mileage \cf2 INT NOT NULL\cf4 ,\
    \cf2 FOREIGN KEY \cf4 (\cf5 customer_id\cf4 ) \cf2 REFERENCES \cf4 Customer(\cf5 customer_id\cf4 ),\
    \cf2 FOREIGN KEY \cf4 (\cf5 flight_id\cf4 ) \cf2 REFERENCES \cf4 Flight(\cf5 flight_id\cf4 )\
);\
\
\cf2 INSERT INTO Status \cf4 (\cf5 status_name\cf4 ) \cf2 VALUES\
    \cf4 (\cf7 'SILVER'\cf4 ),\
    (\cf7 'GOLD'\cf4 ),\
    (\cf7 'NONE'\cf4 );\
\
\cf2 INSERT INTO \cf4 Customer (\cf5 customer_name\cf4 , \cf5 customer_status\cf4 ) \cf2 VALUES\
    \cf4 (\cf7 'Agustine Riviera'\cf4 , \cf6 1\cf4 ),\
    (\cf7 'Alaina Sepulvida'\cf4 , \cf6 3\cf4 ),\
    (\cf7 'Tom Jones'\cf4 , \cf6 2\cf4 ),\
    (\cf7 'Sam Rio'\cf4 , \cf6 3\cf4 ),\
    (\cf7 'Jessica James'\cf4 , \cf6 1\cf4 ),\
    (\cf7 'Ana Janco'\cf4 , \cf6 1\cf4 ),\
    (\cf7 'Jennifer Cortez'\cf4 , \cf6 2\cf4 ),\
    (\cf7 'Christian Janco'\cf4 , \cf6 1\cf4 );\
\
\cf2 INSERT INTO \cf4 Aircraft (\cf5 aircraft_type\cf4 ) \cf2 VALUES\
    \cf4 (\cf7 'Boeing 747'\cf4 ),\
    (\cf7 'Airbus A330'\cf4 ),\
    (\cf7 'Boeing 777'\cf4 );\
\
\cf2 INSERT INTO \cf4 Flight (\cf5 aircraft_id\cf4 , \cf5 flight_number\cf4 , \cf5 total_aircraft_seats\cf4 , \cf5 flight_mileage\cf4 ) \cf2 VALUES\
    \cf4 (\cf6 1\cf4 , \cf7 'DL143'\cf4 , \cf6 400\cf4 , \cf6 135\cf4 ),\
    (\cf6 2\cf4 , \cf7 'DL122'\cf4 , \cf6 236\cf4 , \cf6 4370\cf4 ),\
    (\cf6 3\cf4 , \cf7 'DL53'\cf4 , \cf6 264\cf4 , \cf6 2078\cf4 ),\
    (\cf6 3\cf4 , \cf7 'DL222'\cf4 , \cf6 264\cf4 , \cf6 1765\cf4 ),\
    (\cf6 1\cf4 , \cf7 'DL37'\cf4 , \cf6 400\cf4 , \cf6 531\cf4 );\
\
\cf2 INSERT INTO \cf4 Mileage (\cf5 customer_id\cf4 , \cf5 flight_id\cf4 , \cf5 total_customer_mileage\cf4 ) \cf2 VALUES\
    \cf4 (\cf6 1\cf4 , \cf6 1\cf4 , \cf6 115235\cf4 ),\
    (\cf6 1\cf4 , \cf6 2\cf4 , \cf6 115235\cf4 ),\
    (\cf6 2\cf4 , \cf6 2\cf4 , \cf6 6008\cf4 ),\
    (\cf6 3\cf4 , \cf6 2\cf4 , \cf6 205767\cf4 ),\
    (\cf6 3\cf4 , \cf6 3\cf4 , \cf6 205767\cf4 ),\
    (\cf6 4\cf4 , \cf6 1\cf4 , \cf6 2653\cf4 ),\
    (\cf6 3\cf4 , \cf6 4\cf4 , \cf6 205767\cf4 ),\
    (\cf6 5\cf4 , \cf6 1\cf4 , \cf6 127656\cf4 ),\
    (\cf6 6\cf4 , \cf6 4\cf4 , \cf6 136773\cf4 ),\
    (\cf6 7\cf4 , \cf6 4\cf4 , \cf6 300582\cf4 ),\
    (\cf6 5\cf4 , \cf6 2\cf4 , \cf6 127656\cf4 ),\
    (\cf6 4\cf4 , \cf6 5\cf4 , \cf6 2653\cf4 ),\
    (\cf6 8\cf4 , \cf6 4\cf4 , \cf6 14642\cf4 );\
\
\cf8 -- 3. En la base de datos de aerol\'edneas escriba el script SQL para obtener el n\'famero total de vuelos en la base de datos.\
\
\cf2 SELECT 
\f1\i \cf9 COUNT
\f0\i0 \cf4 (\cf10 *\cf4 ) \cf2 AS \cf4 total_flights \cf2 FROM \cf4 Mileage;\
\
\cf8 -- 4. En la base de datos de aerol\'edneas escriba el script SQL para obtener\
-- la distancia promedio de vuelo.\
\
\cf2 SELECT 
\f1\i \cf9 AVG
\f0\i0 \cf4 (\cf5 total_customer_mileage\cf4 ) \cf2 AS \cf4 average_distance \cf2 FROM \cf4 Mileage;\
\
\cf8 -- 5. En la base de datos de aerol\'edneas escriba el script SQL para obtener\
-- el n\'famero promedio de asientos.\
\
\cf2 SELECT 
\f1\i \cf9 AVG
\f0\i0 \cf4 (\cf5 total_aircraft_seats\cf4 ) \cf2 AS \cf4 average_seats \cf2 FROM \cf4 Flight;\
\
\cf8 -- 6. En la base de datos de aerol\'edneas escriba el script SQL para obtener\
-- el n\'famero promedio de millas voladas por los clientes agrupados por estatus.\
\
\cf2 SELECT \cf5 status_name\cf4 , 
\f1\i \cf9 AVG
\f0\i0 \cf4 (\cf5 total_customer_mileage\cf4 ) \cf2 AS \cf4 average_mileage \cf2 FROM \cf4 Mileage\
    \cf2 INNER JOIN \cf4 Customer \cf2 ON \cf4 Mileage.\cf5 customer_id \cf4 = Customer.\cf5 customer_id\
    \cf2 INNER JOIN Status ON \cf4 Customer.\cf5 customer_status \cf4 = \cf2 Status\cf4 .\cf5 status_id \cf2 GROUP BY \cf5 status_name\cf4 ;\
\
\cf8 -- 7. En la base de datos de aerol\'edneas escriba el script SQL para obtener\
-- el n\'famero m\'e1ximo de millas voladas por los clientes agrupados por estatus.\
\
\cf2 SELECT \cf5 status_name\cf4 , 
\f1\i \cf9 MAX
\f0\i0 \cf4 (\cf5 total_customer_mileage\cf4 ) \cf2 AS \cf4 max_mileage \cf2 FROM \cf4 Mileage\
    \cf2 INNER JOIN \cf4 Customer \cf2 ON \cf4 Mileage.\cf5 customer_id \cf4 = Customer.\cf5 customer_id\
    \cf2 INNER JOIN Status ON \cf4 Customer.\cf5 customer_status \cf4 = \cf2 Status\cf4 .\cf5 status_id \cf2 GROUP BY \cf5 status_name\cf4 ;\
\
\cf8 -- 8. En la base de datos de aerol\'edneas escriba el script SQL para obtener\
-- el n\'famero total de aeronaves con un nombre que contiene Boeing.\
\
\cf2 SELECT 
\f1\i \cf9 COUNT
\f0\i0 \cf4 (\cf10 *\cf4 ) \cf2 AS \cf4 total_boeing_aircraft \cf2 FROM \cf4 Aircraft \cf2 WHERE \cf5 aircraft_type \cf2 LIKE \cf7 '%Boeing%'\cf4 ;\
\
\cf8 -- 9. En la base de datos de aerol\'edneas escriba el script SQL para encontrar\
-- todos los vuelos con una distancia entre 300 y 2000 millas.\
\
-- SELECT flight_number, COUNT(*) FROM Flight WHERE flight_mileage BETWEEN 300 AND 2000 GROUP BY flight_number;\
\
\cf2 SELECT \cf10 * \cf2 FROM \cf4 Flight \cf2 WHERE \cf5 flight_mileage \cf2 BETWEEN \cf6 300 \cf2 AND \cf6 2000\cf4 ;\
\
\cf8 -- 10. En la base de datos de aerol\'edneas escriba el script SQL para encontrar\
-- la distancia promedio de vuelo reservada agrupada por estatus de cliente (esto requerir\'e1 una uni\'f3n).\
\
\cf2 SELECT \cf5 status_name\cf4 , 
\f1\i \cf9 AVG
\f0\i0 \cf4 (\cf5 flight_mileage\cf4 ) \cf2 AS \cf4 average_flight_mileage \cf2 FROM \cf4 Mileage\
    \cf2 INNER JOIN \cf4 Customer \cf2 ON \cf4 Mileage.\cf5 customer_id \cf4 = Customer.\cf5 customer_id\
    \cf2 INNER JOIN Status ON \cf4 Customer.\cf5 customer_status \cf4 = \cf2 Status\cf4 .\cf5 status_id\
    \cf2 INNER JOIN \cf4 Flight \cf2 ON \cf4 Mileage.\cf5 flight_id \cf4 = Flight.\cf5 flight_id \cf2 GROUP BY \cf5 status_name\cf4 ;\
\
\cf8 -- 11. En la base de datos de aerol\'edneas escriba el script SQL para encontrar\
-- la aeronave m\'e1s a menudo reservada por los miembros de estatus de oro (esto requerir\'e1 una uni\'f3n).\
\
\cf2 SELECT 
\f1\i \cf9 MAX
\f0\i0 \cf4 (\cf5 aircraft_type\cf4 ) \cf2 AS \cf4 most_reserved_aircraft \cf2 FROM \cf4 Aircraft\
    \cf2 INNER JOIN \cf4 Flight \cf2 ON \cf4 Aircraft.\cf5 aircraft_id \cf4 = Flight.\cf5 aircraft_id\
    \cf2 INNER JOIN \cf4 Mileage \cf2 ON \cf4 Flight.\cf5 flight_id \cf4 = Mileage.\cf5 flight_id\
    \cf2 INNER JOIN \cf4 Customer \cf2 ON \cf4 Mileage.\cf5 customer_id \cf4 = Customer.\cf5 customer_id\
    \cf2 INNER JOIN Status ON \cf4 Customer.\cf5 customer_status \cf4 = \cf2 Status\cf4 .\cf5 status_id\
    \cf2 WHERE \cf5 status_name \cf4 = \cf7 'GOLD'\cf4 ;\
}